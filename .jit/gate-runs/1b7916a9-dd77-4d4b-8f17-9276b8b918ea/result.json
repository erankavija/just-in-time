{
  "schema_version": 1,
  "run_id": "1b7916a9-dd77-4d4b-8f17-9276b8b918ea",
  "gate_key": "fmt",
  "stage": "postcheck",
  "issue_id": "765f06b2-f0cc-4805-9692-0a80efd77aed",
  "commit": "889efc401186a805351d985509c405a453a25d37",
  "branch": "feature/worktree-parallel-work",
  "status": "failed",
  "started_at": "2026-02-02T17:03:31.013843800Z",
  "completed_at": "2026-02-02T17:03:31.416575985Z",
  "duration_ms": 402,
  "exit_code": 1,
  "stdout": "Diff in /home/vkaskivuo/Projects/just-in-time/crates/jit/src/main.rs:1871:\n                             \"use_unified_envelope\": config.events().use_unified_envelope(),\n                         },\n                     });\n\u001b[31m-                    println!(\"{}\", JsonOutput::success(output, \"config show\").to_json_string()?);\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"{}\",\n\u001b[m\u000f\u001b[32m+                        JsonOutput::success(output, \"config show\").to_json_string()?\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f                 } else {\n                     println!(\"Effective Configuration:\");\n                     println!();\nDiff in /home/vkaskivuo/Projects/just-in-time/crates/jit/src/main.rs:1878:\n                     println!(\"[worktree]\");\n\u001b[31m-                    println!(\"  mode = {:?}\", config.worktree_mode().unwrap_or(jit::config::WorktreeMode::Auto));\n\u001b[m\u000f\u001b[31m-                    println!(\"  enforce_leases = {:?}\", config.enforcement_mode().unwrap_or(jit::config::EnforcementMode::Strict));\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"  mode = {:?}\",\n\u001b[m\u000f\u001b[32m+                        config\n\u001b[m\u000f\u001b[32m+                            .worktree_mode()\n\u001b[m\u000f\u001b[32m+                            .unwrap_or(jit::config::WorktreeMode::Auto)\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"  enforce_leases = {:?}\",\n\u001b[m\u000f\u001b[32m+                        config\n\u001b[m\u000f\u001b[32m+                            .enforcement_mode()\n\u001b[m\u000f\u001b[32m+                            .unwrap_or(jit::config::EnforcementMode::Strict)\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f                     println!();\n                     println!(\"[coordination]\");\n\u001b[31m-                    println!(\"  default_ttl_secs = {}\", config.coordination().default_ttl_secs());\n\u001b[m\u000f\u001b[31m-                    println!(\"  heartbeat_interval_secs = {}\", config.coordination().heartbeat_interval_secs());\n\u001b[m\u000f\u001b[31m-                    println!(\"  lease_renewal_threshold_pct = {}\", config.coordination().lease_renewal_threshold_pct());\n\u001b[m\u000f\u001b[31m-                    println!(\"  stale_threshold_secs = {}\", config.coordination().stale_threshold_secs());\n\u001b[m\u000f\u001b[31m-                    println!(\"  max_indefinite_leases_per_agent = {}\", config.coordination().max_indefinite_leases_per_agent());\n\u001b[m\u000f\u001b[31m-                    println!(\"  max_indefinite_leases_per_repo = {}\", config.coordination().max_indefinite_leases_per_repo());\n\u001b[m\u000f\u001b[31m-                    println!(\"  auto_renew_leases = {}\", config.coordination().auto_renew_leases());\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"  default_ttl_secs = {}\",\n\u001b[m\u000f\u001b[32m+                        config.coordination().default_ttl_secs()\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"  heartbeat_interval_secs = {}\",\n\u001b[m\u000f\u001b[32m+                        config.coordination().heartbeat_interval_secs()\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"  lease_renewal_threshold_pct = {}\",\n\u001b[m\u000f\u001b[32m+                        config.coordination().lease_renewal_threshold_pct()\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"  stale_threshold_secs = {}\",\n\u001b[m\u000f\u001b[32m+                        config.coordination().stale_threshold_secs()\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"  max_indefinite_leases_per_agent = {}\",\n\u001b[m\u000f\u001b[32m+                        config.coordination().max_indefinite_leases_per_agent()\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"  max_indefinite_leases_per_repo = {}\",\n\u001b[m\u000f\u001b[32m+                        config.coordination().max_indefinite_leases_per_repo()\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"  auto_renew_leases = {}\",\n\u001b[m\u000f\u001b[32m+                        config.coordination().auto_renew_leases()\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f                     println!();\n                     println!(\"[global_operations]\");\n\u001b[31m-                    println!(\"  require_main_history = {}\", config.global_operations().require_main_history());\n\u001b[m\u000f\u001b[31m-                    println!(\"  allowed_branches = {:?}\", config.global_operations().allowed_branches());\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"  require_main_history = {}\",\n\u001b[m\u000f\u001b[32m+                        config.global_operations().require_main_history()\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"  allowed_branches = {:?}\",\n\u001b[m\u000f\u001b[32m+                        config.global_operations().allowed_branches()\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f                     println!();\n                     println!(\"[locks]\");\n                     println!(\"  max_age_secs = {}\", config.locks().max_age_secs());\nDiff in /home/vkaskivuo/Projects/just-in-time/crates/jit/src/main.rs:1897:\n                     println!(\"  enable_metadata = {}\", config.locks().enable_metadata());\n                     println!();\n                     println!(\"[events]\");\n\u001b[31m-                    println!(\"  enable_sequences = {}\", config.events().enable_sequences());\n\u001b[m\u000f\u001b[31m-                    println!(\"  use_unified_envelope = {}\", config.events().use_unified_envelope());\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"  enable_sequences = {}\",\n\u001b[m\u000f\u001b[32m+                        config.events().enable_sequences()\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"  use_unified_envelope = {}\",\n\u001b[m\u000f\u001b[32m+                        config.events().use_unified_envelope()\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f                 }\n             }\n             jit::cli::ConfigCommands::Get { key, json } => {\nDiff in /home/vkaskivuo/Projects/just-in-time/crates/jit/src/main.rs:1923:\n \n                 // Parse key and get value\n                 let value: Option<serde_json::Value> = match key.as_str() {\n\u001b[31m-                    \"worktree.mode\" => Some(json!(format!(\"{:?}\", config.worktree_mode().unwrap_or(jit::config::WorktreeMode::Auto)).to_lowercase())),\n\u001b[m\u000f\u001b[31m-                    \"worktree.enforce_leases\" => Some(json!(format!(\"{:?}\", config.enforcement_mode().unwrap_or(jit::config::EnforcementMode::Strict)).to_lowercase())),\n\u001b[m\u000f\u001b[31m-                    \"coordination.default_ttl_secs\" => Some(json!(config.coordination().default_ttl_secs())),\n\u001b[m\u000f\u001b[31m-                    \"coordination.heartbeat_interval_secs\" => Some(json!(config.coordination().heartbeat_interval_secs())),\n\u001b[m\u000f\u001b[31m-                    \"coordination.lease_renewal_threshold_pct\" => Some(json!(config.coordination().lease_renewal_threshold_pct())),\n\u001b[m\u000f\u001b[31m-                    \"coordination.stale_threshold_secs\" => Some(json!(config.coordination().stale_threshold_secs())),\n\u001b[m\u000f\u001b[31m-                    \"coordination.max_indefinite_leases_per_agent\" => Some(json!(config.coordination().max_indefinite_leases_per_agent())),\n\u001b[m\u000f\u001b[31m-                    \"coordination.max_indefinite_leases_per_repo\" => Some(json!(config.coordination().max_indefinite_leases_per_repo())),\n\u001b[m\u000f\u001b[31m-                    \"coordination.auto_renew_leases\" => Some(json!(config.coordination().auto_renew_leases())),\n\u001b[m\u000f\u001b[31m-                    \"global_operations.require_main_history\" => Some(json!(config.global_operations().require_main_history())),\n\u001b[m\u000f\u001b[31m-                    \"global_operations.allowed_branches\" => Some(json!(config.global_operations().allowed_branches())),\n\u001b[m\u000f\u001b[32m+                    \"worktree.mode\" => Some(json!(format!(\n\u001b[m\u000f\u001b[32m+                        \"{:?}\",\n\u001b[m\u000f\u001b[32m+                        config\n\u001b[m\u000f\u001b[32m+                            .worktree_mode()\n\u001b[m\u000f\u001b[32m+                            .unwrap_or(jit::config::WorktreeMode::Auto)\n\u001b[m\u000f\u001b[32m+                    )\n\u001b[m\u000f\u001b[32m+                    .to_lowercase())),\n\u001b[m\u000f\u001b[32m+                    \"worktree.enforce_leases\" => Some(json!(format!(\n\u001b[m\u000f\u001b[32m+                        \"{:?}\",\n\u001b[m\u000f\u001b[32m+                        config\n\u001b[m\u000f\u001b[32m+                            .enforcement_mode()\n\u001b[m\u000f\u001b[32m+                            .unwrap_or(jit::config::EnforcementMode::Strict)\n\u001b[m\u000f\u001b[32m+                    )\n\u001b[m\u000f\u001b[32m+                    .to_lowercase())),\n\u001b[m\u000f\u001b[32m+                    \"coordination.default_ttl_secs\" => {\n\u001b[m\u000f\u001b[32m+                        Some(json!(config.coordination().default_ttl_secs()))\n\u001b[m\u000f\u001b[32m+                    }\n\u001b[m\u000f\u001b[32m+                    \"coordination.heartbeat_interval_secs\" => {\n\u001b[m\u000f\u001b[32m+                        Some(json!(config.coordination().heartbeat_interval_secs()))\n\u001b[m\u000f\u001b[32m+                    }\n\u001b[m\u000f\u001b[32m+                    \"coordination.lease_renewal_threshold_pct\" => {\n\u001b[m\u000f\u001b[32m+                        Some(json!(config.coordination().lease_renewal_threshold_pct()))\n\u001b[m\u000f\u001b[32m+                    }\n\u001b[m\u000f\u001b[32m+                    \"coordination.stale_threshold_secs\" => {\n\u001b[m\u000f\u001b[32m+                        Some(json!(config.coordination().stale_threshold_secs()))\n\u001b[m\u000f\u001b[32m+                    }\n\u001b[m\u000f\u001b[32m+                    \"coordination.max_indefinite_leases_per_agent\" => Some(json!(config\n\u001b[m\u000f\u001b[32m+                        .coordination()\n\u001b[m\u000f\u001b[32m+                        .max_indefinite_leases_per_agent())),\n\u001b[m\u000f\u001b[32m+                    \"coordination.max_indefinite_leases_per_repo\" => Some(json!(config\n\u001b[m\u000f\u001b[32m+                        .coordination()\n\u001b[m\u000f\u001b[32m+                        .max_indefinite_leases_per_repo())),\n\u001b[m\u000f\u001b[32m+                    \"coordination.auto_renew_leases\" => {\n\u001b[m\u000f\u001b[32m+                        Some(json!(config.coordination().auto_renew_leases()))\n\u001b[m\u000f\u001b[32m+                    }\n\u001b[m\u000f\u001b[32m+                    \"global_operations.require_main_history\" => {\n\u001b[m\u000f\u001b[32m+                        Some(json!(config.global_operations().require_main_history()))\n\u001b[m\u000f\u001b[32m+                    }\n\u001b[m\u000f\u001b[32m+                    \"global_operations.allowed_branches\" => {\n\u001b[m\u000f\u001b[32m+                        Some(json!(config.global_operations().allowed_branches()))\n\u001b[m\u000f\u001b[32m+                    }\n\u001b[m\u000f                     \"locks.max_age_secs\" => Some(json!(config.locks().max_age_secs())),\n                     \"locks.enable_metadata\" => Some(json!(config.locks().enable_metadata())),\n                     \"events.enable_sequences\" => Some(json!(config.events().enable_sequences())),\nDiff in /home/vkaskivuo/Projects/just-in-time/crates/jit/src/main.rs:1940:\n\u001b[31m-                    \"events.use_unified_envelope\" => Some(json!(config.events().use_unified_envelope())),\n\u001b[m\u000f\u001b[32m+                    \"events.use_unified_envelope\" => {\n\u001b[m\u000f\u001b[32m+                        Some(json!(config.events().use_unified_envelope()))\n\u001b[m\u000f\u001b[32m+                    }\n\u001b[m\u000f                     _ => None,\n                 };\n \nDiff in /home/vkaskivuo/Projects/just-in-time/crates/jit/src/main.rs:1944:\n                 match value {\n                     Some(v) => {\n                         if json {\n\u001b[31m-                            println!(\"{}\", JsonOutput::success(json!({\"key\": key, \"value\": v}), \"config get\").to_json_string()?);\n\u001b[m\u000f\u001b[32m+                            println!(\n\u001b[m\u000f\u001b[32m+                                \"{}\",\n\u001b[m\u000f\u001b[32m+                                JsonOutput::success(json!({\"key\": key, \"value\": v}), \"config get\")\n\u001b[m\u000f\u001b[32m+                                    .to_json_string()?\n\u001b[m\u000f\u001b[32m+                            );\n\u001b[m\u000f                         } else {\n                             println!(\"{}\", v);\n                         }\nDiff in /home/vkaskivuo/Projects/just-in-time/crates/jit/src/main.rs:1951:\n                     }\n                     None => {\n\u001b[31m-                        anyhow::bail!(\"Unknown config key: {}. Use 'jit config show' to see available keys.\", key);\n\u001b[m\u000f\u001b[32m+                        anyhow::bail!(\n\u001b[m\u000f\u001b[32m+                            \"Unknown config key: {}. Use 'jit config show' to see available keys.\",\n\u001b[m\u000f\u001b[32m+                            key\n\u001b[m\u000f\u001b[32m+                        );\n\u001b[m\u000f                     }\n                 }\n             }\nDiff in /home/vkaskivuo/Projects/just-in-time/crates/jit/src/main.rs:1957:\n\u001b[31m-            jit::cli::ConfigCommands::Set { key, value, global, json } => {\n\u001b[m\u000f\u001b[32m+            jit::cli::ConfigCommands::Set {\n\u001b[m\u000f\u001b[32m+                key,\n\u001b[m\u000f\u001b[32m+                value,\n\u001b[m\u000f\u001b[32m+                global,\n\u001b[m\u000f\u001b[32m+                json,\n\u001b[m\u000f\u001b[32m+            } => {\n\u001b[m\u000f                 use jit::output::JsonOutput;\n                 use serde_json::json;\n                 use std::fs;\nDiff in /home/vkaskivuo/Projects/just-in-time/crates/jit/src/main.rs:1973:\n                 // Load existing config or create empty\n                 let mut doc = if config_path.exists() {\n                     let content = fs::read_to_string(&config_path)?;\n\u001b[31m-                    content.parse::<toml_edit::DocumentMut>()\n\u001b[m\u000f\u001b[32m+                    content\n\u001b[m\u000f\u001b[32m+                        .parse::<toml_edit::DocumentMut>()\n\u001b[m\u000f                         .map_err(|e| anyhow::anyhow!(\"Failed to parse config: {}\", e))?\n                 } else {\n                     toml_edit::DocumentMut::new()\nDiff in /home/vkaskivuo/Projects/just-in-time/crates/jit/src/main.rs:1995:\n                 // Parse and set value based on expected type\n                 let parsed_value: toml_edit::Item = match key.as_str() {\n                     k if k.ends_with(\"_secs\") || k.ends_with(\"_pct\") || k.contains(\"max_\") => {\n\u001b[31m-                        let num: i64 = value.parse()\n\u001b[m\u000f\u001b[32m+                        let num: i64 = value\n\u001b[m\u000f\u001b[32m+                            .parse()\n\u001b[m\u000f                             .map_err(|_| anyhow::anyhow!(\"Expected numeric value for {}\", key))?;\n                         toml_edit::value(num)\n                     }\nDiff in /home/vkaskivuo/Projects/just-in-time/crates/jit/src/main.rs:2002:\n                     k if k.contains(\"enable_\") || k.contains(\"require_\") || k.contains(\"auto_\") => {\n\u001b[31m-                        let b: bool = value.parse()\n\u001b[m\u000f\u001b[31m-                            .map_err(|_| anyhow::anyhow!(\"Expected boolean (true/false) for {}\", key))?;\n\u001b[m\u000f\u001b[32m+                        let b: bool = value.parse().map_err(|_| {\n\u001b[m\u000f\u001b[32m+                            anyhow::anyhow!(\"Expected boolean (true/false) for {}\", key)\n\u001b[m\u000f\u001b[32m+                        })?;\n\u001b[m\u000f                         toml_edit::value(b)\n                     }\n                     _ => toml_edit::value(&value),\nDiff in /home/vkaskivuo/Projects/just-in-time/crates/jit/src/main.rs:2013:\n                 fs::write(&config_path, doc.to_string())?;\n \n                 if json {\n\u001b[31m-                    println!(\"{}\", JsonOutput::success(json!({\n\u001b[m\u000f\u001b[31m-                        \"key\": key,\n\u001b[m\u000f\u001b[31m-                        \"value\": value,\n\u001b[m\u000f\u001b[31m-                        \"file\": config_path.display().to_string(),\n\u001b[m\u000f\u001b[31m-                        \"scope\": if global { \"user\" } else { \"repo\" }\n\u001b[m\u000f\u001b[31m-                    }), \"config set\").to_json_string()?);\n\u001b[m\u000f\u001b[32m+                    println!(\n\u001b[m\u000f\u001b[32m+                        \"{}\",\n\u001b[m\u000f\u001b[32m+                        JsonOutput::success(\n\u001b[m\u000f\u001b[32m+                            json!({\n\u001b[m\u000f\u001b[32m+                                \"key\": key,\n\u001b[m\u000f\u001b[32m+                                \"value\": value,\n\u001b[m\u000f\u001b[32m+                                \"file\": config_path.display().to_string(),\n\u001b[m\u000f\u001b[32m+                                \"scope\": if global { \"user\" } else { \"repo\" }\n\u001b[m\u000f\u001b[32m+                            }),\n\u001b[m\u000f\u001b[32m+                            \"config set\"\n\u001b[m\u000f\u001b[32m+                        )\n\u001b[m\u000f\u001b[32m+                        .to_json_string()?\n\u001b[m\u000f\u001b[32m+                    );\n\u001b[m\u000f                 } else {\n                     println!(\"Set {} = {} in {}\", key, value, config_path.display());\n                 }\n",
  "stderr": "",
  "command": "cargo fmt -- --check",
  "by": "auto:executor",
  "message": null
}