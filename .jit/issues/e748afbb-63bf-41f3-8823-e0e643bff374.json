{
  "id": "e748afbb-63bf-41f3-8823-e0e643bff374",
  "title": "Comprehensive MCP server test coverage",
  "description": "## Problem\n\nMCP server tests have critical coverage gaps:\n- Only 16 tests total (11 in test.js + 5 in test-labels.js)\n- test-labels.js not executed by npm test\n- **Zero tests for core CRUD operations** (create/update/delete/show)\n- **Zero tests for gate operations** (including --add-gate/--remove-gate we just implemented!)\n- **Zero tests for dependency operations**\n- **Zero tests for state transitions**\n- **Zero tests for bulk operations**\n- **Zero tests for document operations**\n- Shallow validation (checks response exists, not correctness)\n- No end-to-end workflow tests\n\n## Impact\n\n- MCP server is critical for agent orchestration (v1.0 priority)\n- Test coverage ~15% of actual functionality\n- High risk of breakage when modifying CLI\n- New features (like gate flags) have zero MCP coverage\n- Cannot validate agent workflow correctness\n\n## Current Test Coverage\n\n### ✅ What's Tested (Protocol Layer):\n- MCP protocol initialization\n- Tool registration and listing\n- Basic search functionality  \n- Label queries\n- Strategic queries\n- Error handling (basic)\n\n### ❌ Critical Gaps:\n\n**Issue Operations (0% coverage):**\n- jit_issue_create (full validation)\n- jit_issue_update (all flags)\n- jit_issue_update with --add-gate/--remove-gate (NEW FEATURE!)\n- jit_issue_delete\n- jit_issue_show\n- jit_issue_claim\n- jit_issue_assign/unassign\n- jit_issue_breakdown\n\n**Gate Operations (0% coverage):**\n- jit_gate_define\n- jit_gate_add\n- jit_gate_remove  \n- jit_gate_pass/fail\n- jit_gate_check/check-all\n- jit_gate_list\n\n**Dependency Operations (0% coverage):**\n- jit_dep_add\n- jit_dep_rm\n- Cycle detection\n- Graph operations\n\n**Bulk Operations (0% coverage):**\n- Batch update with --filter\n- Bulk state transitions\n- Bulk label/gate operations\n\n**Document Operations (0% coverage):**\n- jit_doc_add\n- jit_doc_list\n- jit_doc_show\n\n**Workflows (0% coverage):**\n- No end-to-end workflow tests\n- No multi-step operation tests\n\n## Acceptance Criteria\n\n### Phase 1: Core CRUD (High Priority)\n- [ ] Add tests for jit_issue_create (all parameters)\n- [ ] Add tests for jit_issue_update (including gate flags!)\n- [ ] Add tests for jit_issue_show\n- [ ] Add tests for jit_issue_delete\n- [ ] Add test-labels.js to npm test script\n- [ ] Verify state changes persist correctly\n\n### Phase 2: Gate Operations (High Priority)\n- [ ] Add tests for jit_gate_define\n- [ ] Add tests for jit_gate_add/remove\n- [ ] Add tests for jit_gate_pass/fail\n- [ ] Add tests for gate validation and blocking\n- [ ] Test --add-gate/--remove-gate flags (issue 93d1caf7)\n\n### Phase 3: Dependencies & State (Medium Priority)\n- [ ] Add tests for jit_dep_add/rm\n- [ ] Add tests for cycle detection\n- [ ] Add tests for state transitions\n- [ ] Add tests for dependency blocking\n\n### Phase 4: Integration & Workflows (Medium Priority)\n- [ ] Add end-to-end workflow tests (create → update → gates → done)\n- [ ] Add multi-issue batch operation tests\n- [ ] Add document operation tests\n- [ ] Add concurrent operation tests\n\n### Phase 5: Quality Improvements (Low Priority)\n- [ ] Add schema validation tests\n- [ ] Add error recovery tests\n- [ ] Improve test assertions (verify content, not just existence)\n- [ ] Add performance/timeout tests\n\n## Implementation Notes\n\n- Use existing test infrastructure (MCPTester class)\n- Follow pattern from test-labels.js\n- Ensure each test is isolated (clean state)\n- Use descriptive test names\n- Verify actual data changes, not just response format\n\n## Success Metrics\n\n- Test count: 16 → 100+ tests\n- Coverage: ~15% → ~80% of MCP tools\n- All new features have MCP tests before merge\n- CI runs both test.js and test-labels.js\n\n## References\n\n- Current tests: mcp-server/test.js, mcp-server/test-labels.js\n- Issue 93d1caf7: Gate modification flags (needs tests!)\n- Epic 4a00b2b0: AI Agent Validation (depends on comprehensive tests)",
  "state": "ready",
  "priority": "critical",
  "assignee": null,
  "dependencies": [],
  "gates_required": [],
  "gates_status": {},
  "context": {},
  "documents": [],
  "labels": [
    "type:task",
    "component:mcp-server",
    "milestone:v1.0",
    "epic:agent-validation"
  ]
}