{
  "id": "6f678db0-aef5-4986-95d4-71fa63548fd2",
  "title": "Phase 2: Collapse/Expand Interactivity",
  "description": "Add interactive collapse/expand functionality to cluster containers and individual nodes within clusters.\n\n## Scope\n\nBuild on Phase 1's cluster layout foundation to add user-driven collapse/expand interactions, making large graphs navigable by hiding/showing details on demand.\n\n## Key Features\n\n### 2.1 Cluster container collapse/expand\n- Click epic container header to toggle expanded/collapsed state\n- Collapsed: Show only epic node, hide all internal nodes (stories/tasks)\n- Virtual edges: Aggregate all child dependencies to cluster boundary\n- Visual indicator: Badge showing hidden node count when collapsed\n- Tests: cluster collapse, virtual edge generation\n\n### 2.2 Story-level collapse within clusters\n- Click story nodes to collapse/expand their tasks\n- Collapsed story inherits all task dependencies\n- Expanded shows full task breakdown\n- Tests: nested collapse (story in epic), edge aggregation\n\n### 2.3 Expansion state persistence\n- Save expansion state to URL params (shareable links)\n- Consider localStorage fallback for persistence across sessions\n- \"Expand all\" / \"Collapse all\" toolbar buttons\n- \"Focus on node\" - expand path to selected node\n- Tests: URL param serialization, restore state\n\n### 2.4 Visual polish for collapse/expand\n- Smooth animations for expand/collapse transitions\n- Collapse/expand icons (⊞/⊟) on container headers\n- Hover states for interactive elements\n- Different node styles for collapsed vs expanded containers\n- Tests: visual regression tests\n\n## Success Criteria\n\n- [ ] Clicking cluster header toggles collapse/expand\n- [ ] Collapsed clusters show badge with hidden node count\n- [ ] Virtual edges correctly aggregate when cluster collapses\n- [ ] Story-level collapse works within expanded clusters\n- [ ] Expansion state persists in URL (shareable)\n- [ ] \"Expand all\" / \"Collapse all\" buttons work\n- [ ] All tests passing (TDD)\n- [ ] Code review passed\n\n## Foundation from Phase 1\n\nPhase 1 already provides:\n- ExpansionState type definition\n- aggregateEdgesForCollapsed() algorithm\n- Virtual edge rendering infrastructure\n- Cluster boundary edge handling\n\nPhase 2 adds the UI layer and state management on top.",
  "state": "in_progress",
  "priority": "normal",
  "assignee": "agent:copilot-session",
  "dependencies": [],
  "gates_required": [
    "tdd-reminder",
    "code-review"
  ],
  "gates_status": {
    "code-review": {
      "status": "pending",
      "updated_by": null,
      "updated_at": "2026-02-04T14:07:22.850633367Z"
    },
    "tdd-reminder": {
      "status": "passed",
      "updated_by": "agent:copilot-session",
      "updated_at": "2026-02-06T19:50:31.405020675Z"
    }
  },
  "context": {},
  "documents": [
    {
      "path": "dev/design/phase2-collapse-expand.md",
      "commit": null,
      "label": "Phase 2 Implementation Plan",
      "doc_type": "design",
      "format": "markdown"
    }
  ],
  "labels": [
    "epic:production-polish",
    "component:web",
    "type:task"
  ]
}