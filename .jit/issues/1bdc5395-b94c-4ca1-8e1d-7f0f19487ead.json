{
  "id": "1bdc5395-b94c-4ca1-8e1d-7f0f19487ead",
  "title": "Refactor: Address code quality improvements from CLI command implementation",
  "description": "Address seven code quality issues identified during CLI command implementation (claim/worktree commands):\n\n1. **Test quality: Conditional assertions**\n   - Example: test_detect_in_main_worktree had backwards logic\n   - Solution: Add clippy rule or use property-based testing to catch this pattern\n\n2. **Unused storage parameter pattern**\n   - Problem: Most execute_claim_* and execute_worktree_* functions take unused _storage parameter\n   - Example: execute_claim_list<S: IssueStore>(_storage: &S)\n   - Solution: Remove once all commands implemented, or make it Option<&S> if truly optional\n\n3. **Git detection silent fallbacks**\n   - Problem: get_current_branch() returns \"main\" on error, hiding failures\n   - Solution: Return clear error instead of silent fallback\n\n4. **Path handling inconsistency**\n   - Problem: Inconsistent use of canonicalize vs relative paths\n   - Example: Bug fixed in WorktreePaths::detect() where git returned relative path\n   - Solution: Establish rule to always canonicalize paths from external sources (git, user input)\n\n5. **Test helper duplication**\n   - Problem: Each command module has its own setup_test_repo()\n   - Solution: Extract to shared test_utils module\n\n6. **Missing integration tests**\n   - Problem: Good unit coverage but no end-to-end CLI tests\n   - Solution: Add integration tests that run actual jit binary and check exit codes/output\n\n7. **Error messages not actionable**\n   - Problem: Errors like \"Lease not found\" don't suggest remediation\n   - Solution: Add actionable hints (e.g., \"List active leases with: jit claim list\")\n\n## Acceptance Criteria\n\n- [ ] All seven improvements addressed or explicitly deferred with rationale\n- [ ] Tests pass\n- [ ] No regression in existing functionality\n- [ ] Code quality improves measurably (fewer potential bug patterns)",
  "state": "done",
  "priority": "high",
  "assignee": null,
  "dependencies": [],
  "gates_required": [],
  "gates_status": {},
  "context": {},
  "documents": [
    {
      "path": "dev/sessions/session-20260201-refactor-1bdc5395-analysis.md",
      "commit": null,
      "label": "Refactor analysis - status of 7 issues",
      "doc_type": "notes"
    }
  ],
  "labels": [
    "epic:parallel-work",
    "milestone:v1.0",
    "component:testing",
    "component:cli",
    "type:task"
  ]
}