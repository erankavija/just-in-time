{
  "id": "7004d5b6-0f4d-4dd7-9623-6d953ff94025",
  "title": "Reorganize commands module to separate CLI from domain logic",
  "description": "## Problem\n\nThe `commands/` module currently contains both:\n- **CLI orchestration code** (command execution, output formatting)\n- **Core domain query operations** (`query_by_state()`, `query_by_label()`, `query_ready()`)\n\nThis mixing makes it hard to:\n- Identify reusable library code vs CLI-specific code\n- Use jit as a library (domain logic buried in commands)\n- Understand module boundaries\n- Test domain logic independently\n\n## Current Structure\n\n```\ncrates/jit/src/\n\u251c\u2500\u2500 commands/\n\u2502   \u251c\u2500\u2500 mod.rs              # CLI + domain mixed\n\u2502   \u251c\u2500\u2500 query.rs            # Domain query logic\n\u2502   \u251c\u2500\u2500 issue.rs            # CLI + domain mixed\n\u2502   \u251c\u2500\u2500 document.rs         # CLI + domain mixed\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 domain.rs               # Just data structures\n\u2514\u2500\u2500 lib.rs\n```\n\n## Proposed Structure\n\n**Option 1: Separate queries module**\n```\ncrates/jit/src/\n\u251c\u2500\u2500 commands/               # Pure CLI orchestration\n\u2502   \u251c\u2500\u2500 mod.rs\n\u2502   \u251c\u2500\u2500 issue.rs\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 domain/                 # Domain types + operations\n\u2502   \u251c\u2500\u2500 mod.rs\n\u2502   \u251c\u2500\u2500 types.rs           # Issue, State, Priority, etc.\n\u2502   \u2514\u2500\u2500 queries.rs         # query_by_state, query_ready, etc.\n\u251c\u2500\u2500 query/                  # Query filter engine (already exists)\n\u2514\u2500\u2500 lib.rs\n```\n\n**Option 2: Keep flat but clearer naming**\n```\ncrates/jit/src/\n\u251c\u2500\u2500 commands/               # Pure CLI orchestration\n\u251c\u2500\u2500 domain.rs               # Domain types\n\u251c\u2500\u2500 issue_queries.rs        # Domain query operations\n\u251c\u2500\u2500 query/                  # Query filter engine\n\u2514\u2500\u2500 lib.rs\n```\n\n## Migration Strategy\n\n1. Create new module structure (pick option)\n2. Move query functions from `commands/query.rs` to new location\n3. Update imports throughout codebase\n4. Ensure `CommandExecutor` still has access to domain functions\n5. Update lib.rs exports to expose domain operations\n6. Update documentation to clarify separation\n\n## Benefits\n\n- Clear separation of concerns (CLI vs domain)\n- Easier to use jit as a library\n- Better discoverability of domain operations\n- Cleaner module boundaries\n- Easier to test domain logic independently\n\n## Questions to Decide\n\n1. Which structure option? (Option 1 more scalable, Option 2 simpler)\n2. Should `CommandExecutor` stay in commands/ or move to separate orchestration layer?\n3. What about `parse_state()` and `parse_priority()`? (Domain or commands?)\n\n## Acceptance Criteria\n\n- [ ] Clear separation between CLI and domain logic\n- [ ] Domain query operations easy to find and import\n- [ ] All existing tests pass\n- [ ] lib.rs exports domain operations clearly\n- [ ] Documentation updated\n- [ ] No regression in CLI functionality",
  "state": "done",
  "priority": "low",
  "assignee": "agent:copilot-7004d5b6",
  "dependencies": [],
  "gates_required": [],
  "gates_status": {},
  "context": {},
  "documents": [
    {
      "path": "dev/plans/7004d5b6-reorganize-commands.md",
      "commit": null,
      "label": "Implementation Plan",
      "doc_type": "design",
      "format": "markdown"
    }
  ],
  "labels": [
    "type:task",
    "epic:production-polish",
    "component:core"
  ],
  "created_at": "2025-12-30T22:32:59.466312065Z",
  "updated_at": "2026-02-11T21:34:40.669004251Z"
}
